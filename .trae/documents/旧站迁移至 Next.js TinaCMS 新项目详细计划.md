# 旧站迁移至 Next.js TinaCMS 新项目详细计划

## 概述
- 目标：使用新项目 `/ProductPage/product-site` 的架构（Next.js 14 + App Router + TinaCMS）重新实现（重构）旧项目 `/ProductPage/old-pro` 的页面与功能；不对旧站内容进行逐项映射导入，而是基于旧站文案与资源进行页面组件化重写与信息架构优化。
- 范围：页面重写、组件与交互重构、样式与资源迁移、URL 结构与 SEO、分析与支付集成、构建与部署流程。
- 关键依赖：Next.js、TailwindCSS、TinaCMS（内置于新项目）、Vercel/自托管部署。

## 目标与成功标准
- 页面等价重构：旧站所有页面与核心功能在新站均有等价或更优实现（支持 301 重定向）。
- 体验提升：Lighthouse 性能 ≥ 90、可访问性 ≥ 90、SEO ≥ 90。
- 运营可控：内容通过 TinaCMS 在 `admin` 可编辑发布；监控与回滚方案就绪。
- 无中断：切换期间业务连续，支付与表单功能不受影响。

## 内容审计阶段
- 负责人：PM（统筹）、FE（结构评估）、内容编辑（清单维护）
- 预计耗时：0.5–1 天
- 交付物：
  - 内容清单（页面、模块、资源、交互）：
    - 页面：`index.html`、`products.html`、`product1.html`、`about.html`、`contact.html`、`cases.html`
    - 组件：`components/navbar.html`、`footer.html`、`contact-form.html`、`google-analytics.html`
    - 资源：`assets/images/*`、`assets/css/common.css`、`assets/js/common.js`
  - 兼容性评估报告：与新项目现有结构的差异与风险
- 成功标准：清单覆盖率 100%，每项均标注迁移方式与新址映射

## 技术迁移准备
- 负责人：Tech Lead、FE、DevOps
- 预计耗时：0.5 天
- 任务与交付物：
  - 技术栈分析：旧站纯静态（HTML/CSS/原生 JS），无后端框架，无数据库
  - 新站架构对齐：Next.js App Router（`src/app`）、组件（`src/components`）、内容（`content/*`）、静态资源（`public/*`）、样式（Tailwind + `globals.css`）
  - 重构方案：
    - 页面重写：依据旧站页面信息架构，在 Next.js App Router 下重写为 React 组件与路由，不进行逐项内容文件映射。
    - 资源迁移：`assets/images/*` → `public/images/*`；`common.css` → 使用 TailwindCSS 重构样式，必要时保留少量补充 CSS。
    - 交互重构：`common.js` 的导航/滚动/轻交互 → 以 React 状态与事件实现，移除非必要的原生脚本耦合。
    - 内容管理：为后续运营在 TinaCMS 定义集合与字段，但首版以页面组件内容为主，逐步抽离为可编辑数据。
  - 版本控制：建立迁移分支 `migration/old-pro`，使用 PR 进行审查与合并
- 成功标准：迁移分支建立、方案评审通过、可执行的任务拆解明确

## 重构实施
- 负责人：FE（代码）、内容编辑（录入）、Tech Lead（评审）
- 预计耗时：2–4 天
- 任务与交付物：
  - 页面与路由重写：
    - 首页：在 `src/app/page.tsx` 以组件方式重写旧站首页结构（英雄区、优势、案例预览等）。
    - 产品列表：在 `src/app/products/page.tsx` 重写产品展示逻辑与布局，统一采用新项目组件与样式体系。
    - 产品详情：在 `src/app/products/[slug]/page.tsx` 重写详情模板；首版可内置示例数据，后续接入 TinaCMS。
    - 关于我们：在 `src/app/about/page.tsx` 重写内容结构与排版。
    - 联系我们：在 `src/app/contact/page.tsx` 对齐旧表单字段与校验，复用 Formspree 集成。
    - 案例页：新增 `src/app/cases/page.tsx`，以列表/卡片形式展示案例，后续接入 TinaCMS。
  - 组件重构与复用：
    - 导航：增强 `src/components/Header.tsx` 以匹配旧站导航结构与交互（含 `/cases`）。
    - 页脚：复用并对齐 `src/components/Footer.tsx` 的内容与链接。
    - 联系表单：复用并对齐 `src/components/ContactForm.tsx` 字段与校验逻辑。
    - 分析：复用 `src/components/GoogleAnalytics.tsx`，保持埋点一致。
  - 样式与主题：
    - 使用 Tailwind 原子类重构 `common.css` 的样式语义，必要时在 `src/app/globals.css` 添加少量补充类。
    - 统一间距、颜色、字体，与 `tailwind.config.ts` 保持一致。
  - 资源迁移：
    - 图片：`assets/images/*` → `public/images/*`，按目录保留语义（如 `public/images/cases/*`）
  - 交互逻辑：
    - 将导航高亮、滚动行为等在 React 中实现，去除对旧站脚本的直接依赖。
  - URL 与重定向：
    - 在 `product-site` 的 `next.config.mjs` 中维护旧 URL 到新路由的 301 规则，保障外链与搜索引擎过渡（示例：`/index.html` → `/`、`/products.html` → `/products` 等）。
- 成功标准：各页面在新路由可访问，组件/样式一致，图片路径有效，TinaCMS 能编辑相关内容

## 测试验证阶段
- 负责人：QA、FE、PM
- 预计耗时：1–2 天
- 任务与交付物：
  - 功能测试：导航、列表与详情、联系表单、支付（若使用 `src/components/AlipayPayment.tsx`）、CMS 编辑与预览
  - 兼容性测试：Chrome/Firefox/Safari/Edge；移动端与平板
  - 性能测试：Lighthouse、Core Web Vitals（FCP/LCP/CLS/TBT）；图片优化（SVG/WEBP）、代码分割
  - 无障碍：语义标签、可聚焦元素、颜色对比（WCAG AA）
  - 安全审查：依赖漏洞（`npm audit`）、表单与支付端点校验、环境变量安全
- 成功标准：所有关键用例通过；性能与可访问性指标达标；无高危漏洞

## 切换部署
- 负责人：DevOps、PM、FE（支持）
- 预计耗时：0.5 天
- 任务与交付物：
  - 切换时间表：低峰期发布，预留回滚窗口
  - 部署配置：Vercel 或自托管（`vercel.json` 已存在），设置环境变量与缓存策略
  - 灰度与监控：启用日志、错误监控（Sentry/自建），观察 24–48 小时
- 成功标准：零故障切换，流量稳定，关键路径错误率 < 1%

## 旧网站下线
- 负责人：PM、DevOps
- 预计耗时：0.5 天
- 任务与交付物：
  - 流量核验：确认 301 生效与搜索引擎索引更新
  - 归档：将 `/old-pro` 完整打包归档与存档说明
  - DNS 更新：如有域名切换，更新 A/AAAA/CNAME/记录与 TTL 调整
- 成功标准：旧站无对外入口，归档可恢复，搜索与外链导向新站

## 后续优化
- 负责人：PM、FE、内容编辑
- 预计耗时：持续（首周集中优化）
- 任务与交付物：
  - 用户反馈收集与迭代（客服、问卷、埋点）
  - 内容展现优化：增强组件与布局、图片响应式与懒加载
  - 更新机制：TinaCMS 工作流与发布流程固化（草稿/发布/回滚）
- 成功标准：反馈闭环运作、关键页面转化指标提升、内容更新稳定

## 重构清单（示例）
- 页面
  - 首页：分解旧模块为组件（卡片/英雄/优势区块），以新项目样式与组件库重写。
  - 产品：重写列表与详情组件，首版以内置数据驱动，后续接入 TinaCMS 集合与字段。
  - 案例：新增 `src/app/cases/page.tsx`，并规划 `content/cases/*.md` 以便后续 CMS 管理。
- 组件
  - Navbar：增强 `src/components/Header.tsx`，补充菜单项（含 `/cases`）与当前路由高亮。
  - Footer/ContactForm/Analytics：复用并按需样式对齐。
- 样式
  - 将 `common.css` 的样式意图以 Tailwind 原子类表达；仅保留必要的自定义样式于 `globals.css`。
- 资源
  - 复制 `assets/images/*` → `public/images/*`，按模块划分：`products/`、`cases/`、`common/`。

## 风险与回滚
- 风险：URL 改变引起 SEO 波动；交互差异影响体验；图片路径错误；依赖漏洞
- 缓解：301 重定向全面覆盖；预发布环境验证；脚本检查静态资源路径；`npm audit fix` 与版本锁定
- 回滚：保留旧站备份；DNS/路由级别快速回切；构建产物与环境变量版本化

## 里程碑与时间估算
- M1 审计与方案（第 1 天）
  - 负责人：PM、Tech Lead、FE、内容编辑
  - 交付物：内容清单、信息架构草图（IA）、重构任务拆解与排期、风险清单
  - 成功标准：清单覆盖 100%；方案评审通过；风险与缓解措施明确
  - 输出格式：Markdown 文档与看板任务条目（含负责人与截止时间）

- M2 重构开发（第 2–4 天）
  - 负责人：FE（主）、Tech Lead（评审）、内容编辑（文案校验）
  - 交付物：页面重写 PR（首页/产品列表/详情/关于/联系/案例）、组件更新、样式迁移、资源拷贝
  - 成功标准：路由均可访问；组件与样式一致；无严重 UI 偏差；控制台无报错
  - 输出格式：分页面 PR，关联任务与截图对比（旧/新）

- M3 测试与优化（第 5–6 天）
  - 负责人：QA（主）、FE、PM
  - 交付物：Lighthouse 报告、跨端兼容性报告、无障碍检查清单、修复项列表与落地 PR
  - 成功标准：性能/可访问性/SEO ≥ 90；关键用例全部通过；无高危漏洞
  - 输出格式：测试报告（截图与分数）、问题清单与修复提交链接

- M4 切换与监控（第 7 天）
  - 负责人：DevOps、PM、FE（支持）
  - 交付物：部署记录、重定向配置、监控面板链接、回滚操作手册
  - 成功标准：零故障切换；监控稳定；错误率 < 1%
  - 输出格式：部署日志、配置清单、监控截图与回滚步骤

## 角色与职责
- PM：进度把控、验收与沟通
- Tech Lead：方案设计、代码评审、质量门禁
- FE：页面与组件迁移、样式与交互实现
- 内容编辑：TinaCMS 内容录入与校验
- QA：测试计划执行与报告
- DevOps：部署、监控、回滚与 DNS

## 交付物清单
- 内容清单与映射文档
- 迁移分支与合并 PR
- 新增/改造页面与组件代码
- 301 重定向与构建配置
- 测试报告与性能/无障碍指标
- 切换与回滚手册；归档包与说明

### 交付物格式规范（补充）
- 文档：Markdown（含目录、负责人、耗时、结论与建议）
- 代码：按页面拆分 PR；遵循命名规范（feat/pages: home, products, product-detail, about, contact, cases）
- 报告：包含截图、分数与版本信息；附可复现步骤与环境说明

## 页面重构要点与验收标准

### 首页（`/`）
- 负责人：FE、内容编辑；预计耗时：0.5 天
- 重构要点：
  - 组件划分：Hero、优势模块、产品/案例预览、CTA 区域
  - 样式：Tailwind 重构旧 `common.css` 的布局与间距；保持主题一致
  - 性能：图片懒加载与优化；关键渲染路径压缩；减少阻塞脚本
  - SEO：语义结构、标题层级、meta 与 Open Graph
- 验收标准：
  - 路由 `/` 可访问，布局与交互符合设计
  - Lighthouse Performance/Accessibility/SEO ≥ 90；CLS < 0.1
  - 移动/平板/桌面断点适配正常；控制台无报错

### 产品列表（`/products`）
- 负责人：FE；预计耗时：0.5 天
- 重构要点：
  - 数据：复用 `src/lib/products.ts`，首版使用内置/Mock 数据
  - 组件：卡片布局（图片、名称、价格、链接）；空态与占位图
  - 性能：懒加载、图片尺寸合适；避免重复渲染
- 验收标准：
  - 至少渲染 5 个产品卡片；点击可进入详情页
  - FCP < 2s（本地）；缺图显示占位；控制台无报错
  - 页面可访问性通过（表意标签、焦点可达）

### 产品详情（`/products/[slug]`）
- 负责人：FE；预计耗时：0.5 天
- 重构要点：
  - 组件：主图、标题、描述、价格、SKU、库存、购买按钮
  - 集成：后续接入 Snipcart/Alipay 购买流程；注入 JSON-LD 结构化数据
  - 导航：返回列表链接与相关产品区块（可选）
- 验收标准：
  - 任一 `slug` 页面渲染完整；字段齐全；链接有效
  - JSON-LD 正确注入；无控制台错误
  - 购买按钮可见（不强制联通支付）

### 关于我们（`/about`）
- 负责人：FE、内容编辑；预计耗时：0.5 天
- 重构要点：
  - 文案组织与图片展示；团队/愿景/资质模块
  - 语义标签与可访问性
- 验收标准：
  - 内容完整；语义清晰；Lighthouse ≥ 90
  - 响应式良好；无布局错乱

### 联系我们（`/contact`）
- 负责人：FE；预计耗时：0.5 天
- 重构要点：
  - 表单字段对齐旧站：姓名、电话（国家码+号码）、邮箱（可选）、公司（可选）、咨询内容
  - 集成：Formspree 端点；提交成功/失败状态提示；基础校验与键盘可操作
  - 安全与防垃圾：预留隐性字段或后续验证码接入
- 验收标准：
  - 成功提交到 Formspree 并显示成功提示；错误时提示友好
  - 电话输入格式校验有效；可访问性通过（标签/错误提示/焦点）
  - 弱网/断网时用户可感知状态并可重试

### 案例页（`/cases`）
- 负责人：FE；预计耗时：0.5 天
- 重构要点：
  - 列表/卡片布局；图片与文案占位；后续接入 TinaCMS 集合
  - 响应式与图片优化；布局稳定（控制 Layout Shift）
- 验收标准：
  - 渲染至少 3 个案例卡片占位；点击行为定义（可后续详情页）
  - 图片加载策略合理；页面稳定；无控制台错误

## 项目管理与追踪
- PR 命名与说明规范：`feat/pages: <page>` 或 `fix/<scope>: <desc>`；包含截图与测试说明
- 看板追踪：每个页面一个任务卡，标注负责人、状态与验收链接
- 评审门禁：Tech Lead 审查代码质量与一致性；QA 审查验收项

## 执行注意事项
- 保持文件与命名一致性，遵循现有项目结构与风格。
- 不进行逐项内容映射导入，采用组件化重写，必要内容再逐步抽离为可编辑数据。
- 不引入未使用库；优先复用现有组件与样式。
- 严格环境变量管理，不暴露敏感信息。

—— 请确认以上计划；获批后将按里程碑推进并提交具体改造 PR 与配置变更。
